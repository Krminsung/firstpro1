# 1. 베이스 이미지: API 서버와 동일한 환경을 사용합니다.
FROM python:3.10-slim

# 2. 작업 디렉토리
WORKDIR /app

# 3. 의존성 설치 (API와 동일)
COPY requirements.txt requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# 4. 소스 코드 복사 (API와 동일)
COPY . .

# 5. 실행 명령어: 'jobs'라는 이름의 큐를 바라보는 RQ 워커를 실행합니다.
# (Redis 주소는 K8s 내부 DNS 'redis-service'를 사용합니다.)
CMD ["rq", "worker", "-u", "redis://redis-service:6379", "jobs"]